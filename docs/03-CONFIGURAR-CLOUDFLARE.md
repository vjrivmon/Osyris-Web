# ‚òÅÔ∏è Gu√≠a Paso a Paso: Configurar Cloudflare

## üí∞ Coste: GRATIS (para siempre)

---

## üìã ¬øQu√© es Cloudflare?

Cloudflare proporciona:
- ‚úÖ **DNS r√°pido y seguro** (gratis)
- ‚úÖ **CDN global** (mejora velocidad)
- ‚úÖ **Protecci√≥n DDoS** (seguridad)
- ‚úÖ **SSL/TLS** (HTTPS gratis)
- ‚úÖ **Cach√©** (reduce carga del servidor)
- ‚úÖ **Analytics** (estad√≠sticas)

**Todo gratis en el plan Free.**

---

## üéØ Objetivo

Configurar Cloudflare como:
1. **DNS** del dominio
2. **Proxy** entre usuarios y servidor
3. **CDN** para contenido est√°tico
4. **Firewall** b√°sico

---

## üöÄ Paso 1: Crear Cuenta

### 1.1 Registro

1. Ve a: **https://dash.cloudflare.com/sign-up**
2. Rellena formulario:

```
Email Address: admin@grupooosyris.es
Password: [Contrase√±a segura - diferente a otras]
```

3. Click **"Create Account"**

### 1.2 Verificar Email

1. Revisa tu email
2. Busca email de: `no-reply@notify.cloudflare.com`
3. Asunto: "Verify your email address for Cloudflare"
4. Click en **"Verify email address"**
5. Te redirigir√° al dashboard

**‚è±Ô∏è Tiempo: 2 minutos**

---

## üåê Paso 2: A√±adir Dominio

### 2.1 Iniciar Configuraci√≥n

1. En el dashboard de Cloudflare
2. Click en **"Add a Site"** (arriba a la derecha)
3. O en el centro: **"Add a domain"**

### 2.2 Introducir Dominio

**Introduce tu dominio:**
```
grupooosyris.es
```

**‚ö†Ô∏è IMPORTANTE:**
- Sin `www.`
- Sin `https://`
- Solo el dominio: `grupooosyris.es`

Click **"Add site"**

### 2.3 Seleccionar Plan

Ver√°s opciones de planes:

| Plan | Precio | Caracter√≠sticas |
|------|--------|-----------------|
| **Free** | ‚Ç¨0/mes | DNS, SSL, CDN b√°sico |
| **Pro** | ‚Ç¨20/mes | Optimizaciones extra |
| **Business** | ‚Ç¨180/mes | Para empresas |

**Seleccionar:** **Free** ‚≠ê

Click **"Continue"**

**‚è±Ô∏è Tiempo: 1 minuto**

---

## üîç Paso 3: Escaneo de DNS

Cloudflare escanear√° los registros DNS existentes.

### 3.1 Esperar Escaneo

Ver√°s:
```
Querying grupooosyris.es nameservers...
‚è≥ This may take up to 60 seconds
```

**Espera 30-60 segundos.**

### 3.2 Revisar Registros

Cloudflare mostrar√° los registros DNS encontrados.

**Probablemente ver√°s:**
- Algunos registros gen√©ricos del registrador
- Registros que puedes eliminar

**NO te preocupes**, los configuraremos correctamente despu√©s.

Click **"Continue"**

**‚è±Ô∏è Tiempo: 2 minutos**

---

## üîß Paso 4: Configurar Nameservers

Este es el paso m√°s importante.

### 4.1 Obtener Nameservers de Cloudflare

Cloudflare te mostrar√°:

```
Change your nameservers

Replace your nameservers with these:

1. bob.ns.cloudflare.com
2. kate.ns.cloudflare.com

These nameservers are unique to your account.
```

**‚ö†Ô∏è IMPORTANTE:** Los nameservers ser√°n diferentes para tu cuenta. Anota los tuyos.

**Copia estos nameservers**, los necesitar√°s en el siguiente paso.

**NO hagas click en "Done, check nameservers" todav√≠a.**

### 4.2 Cambiar Nameservers en tu Registrador

Ahora cambiaremos los nameservers en Namecheap o DonDominio.

---

#### üìå OPCI√ìN A: Namecheap

##### Paso 4.2.1: Acceder al Panel

1. Ve a: **https://ap.www.namecheap.com**
2. Login con tus credenciales
3. Click en **"Domain List"** (men√∫ izquierdo)
4. Ver√°s tu dominio listado: `grupooosyris.es`

##### Paso 4.2.2: Gestionar Dominio

1. Click en **"Manage"** (bot√≥n a la derecha del dominio)
2. Ver√°s la p√°gina de configuraci√≥n del dominio

##### Paso 4.2.3: Cambiar Nameservers

1. Busca la secci√≥n **"Nameservers"**
2. Por defecto estar√° en: `Namecheap BasicDNS`
3. Click en el dropdown
4. Seleccionar: **"Custom DNS"**

##### Paso 4.2.4: Introducir Nameservers de Cloudflare

Ver√°s dos campos:
```
Nameserver 1: [campo vac√≠o]
Nameserver 2: [campo vac√≠o]
```

**Introduce los nameservers de Cloudflare:**
```
Nameserver 1: bob.ns.cloudflare.com
Nameserver 2: kate.ns.cloudflare.com
```

**(Reemplaza con los tuyos de Cloudflare)**

##### Paso 4.2.5: Guardar

1. Click en el **‚úì (check)** verde
2. Ver√°s mensaje: "Nameservers updated successfully"

**‚è±Ô∏è Tiempo: 5 minutos**

---

#### üìå OPCI√ìN B: DonDominio

##### Paso 4.2.1: Acceder al Panel

1. Ve a: **https://www.dondominio.com/panel**
2. Login con tus credenciales
3. En el men√∫, click **"Dominios"**
4. Ver√°s tu dominio: `grupooosyris.es`

##### Paso 4.2.2: Gestionar Dominio

1. Click en el dominio `grupooosyris.es`
2. O click en **"Gestionar"** / icono de configuraci√≥n

##### Paso 4.2.3: Cambiar DNS

1. Busca la secci√≥n **"Servidores DNS"** o **"Nameservers"**
2. Click en **"Modificar"** o **"Editar"**

##### Paso 4.2.4: Introducir Nameservers

Ver√°s campos:
```
DNS 1: [actual]
DNS 2: [actual]
```

**Cambiar a los de Cloudflare:**
```
DNS 1: bob.ns.cloudflare.com
DNS 2: kate.ns.cloudflare.com
```

**(Reemplaza con los tuyos de Cloudflare)**

##### Paso 4.2.5: Guardar

1. Click en **"Guardar"** o **"Actualizar"**
2. Confirmar cambios
3. Ver√°s mensaje de confirmaci√≥n

**‚è±Ô∏è Tiempo: 5 minutos**

---

### 4.3 Volver a Cloudflare

1. Vuelve a la pesta√±a de Cloudflare
2. Click en **"Done, check nameservers"**

Ver√°s:
```
Checking nameservers...
‚è≥ This can take up to 24 hours
```

### 4.4 Esperar Propagaci√≥n

**Tiempo de propagaci√≥n DNS:**
- **M√≠nimo:** 5-15 minutos
- **T√≠pico:** 1-4 horas
- **M√°ximo:** 24-48 horas

**No cierres la pesta√±a**, pero puedes seguir con otros pasos.

**‚è±Ô∏è Tiempo de espera: 15 minutos - 4 horas**

---

## ‚úÖ Paso 5: Verificar Propagaci√≥n

### 5.1 Verificar en Terminal

```bash
# Verificar nameservers
dig grupooosyris.es NS +short

# Deber√≠a mostrar:
# bob.ns.cloudflare.com
# kate.ns.cloudflare.com
```

### 5.2 Verificar en Web

1. Ve a: **https://www.whatsmydns.net**
2. Introduce: `grupooosyris.es`
3. Tipo: `NS`
4. Click **"Search"**

**Ver√°s propagaci√≥n global:**
- ‚úÖ Verde: Propagado
- ‚è≥ Amarillo: En progreso
- ‚ùå Rojo: No propagado

**Espera hasta que la mayor√≠a est√©n en verde.**

### 5.3 Confirmaci√≥n en Cloudflare

Cuando se complete, recibir√°s email:
```
Asunto: Cloudflare is now protecting grupooosyris.es

Your site is now active on a Cloudflare Free plan.
```

**En el dashboard ver√°s:**
```
‚úÖ Status: Active
```

**‚è±Ô∏è Tiempo: Variable (15 min - 4 horas)**

---

## üåê Paso 6: Configurar Registros DNS

Una vez activo en Cloudflare, configuraremos los registros DNS.

### 6.1 Acceder a DNS

1. En Cloudflare Dashboard
2. Seleccionar dominio: `grupooosyris.es`
3. Click en **"DNS"** (men√∫ lateral izquierdo)
4. Tab **"Records"**

### 6.2 Eliminar Registros Existentes (Opcional)

Si hay registros que no necesitas, elim√≠nalos:
- Click en los tres puntos `‚ãÆ`
- Click **"Delete"**

**Conserva solo si sabes qu√© hacen.**

### 6.3 A√±adir Registro A para Ra√≠z

**Este es el registro principal para tu dominio.**

Click **"Add record"**

**Configuraci√≥n:**
```
Type: A
Name: @
IPv4 address: [TU_IP_HETZNER]
Proxy status: üî¥ DNS only (gris/desactivado)
TTL: Auto
```

**Ejemplo:**
```
Type: A
Name: @
IPv4 address: 95.217.123.45
Proxy status: üî¥ DNS only
TTL: Auto
```

**‚ö†Ô∏è IMPORTANTE:**
- **Proxy status: DNS only (gris)** - Temporalmente para obtener SSL
- Lo cambiaremos a "Proxied" despu√©s

Click **"Save"**

### 6.4 A√±adir Registro A para WWW

Para que `www.grupooosyris.es` tambi√©n funcione.

Click **"Add record"**

**Configuraci√≥n:**
```
Type: A
Name: www
IPv4 address: [TU_IP_HETZNER]
Proxy status: üî¥ DNS only (gris/desactivado)
TTL: Auto
```

Click **"Save"**

### 6.5 Verificar Registros

Deber√≠as tener:

| Type | Name | Content | Proxy Status |
|------|------|---------|--------------|
| A | @ | 95.217.123.45 | üî¥ DNS only |
| A | www | 95.217.123.45 | üî¥ DNS only |

**‚è±Ô∏è Tiempo: 5 minutos**

---

## üîç Paso 7: Verificar DNS

### 7.1 Esperar Propagaci√≥n (5-10 minutos)

```bash
# Verificar dominio ra√≠z
dig grupooosyris.es +short
# Debe mostrar: 95.217.123.45 (tu IP)

# Verificar www
dig www.grupooosyris.es +short
# Debe mostrar: 95.217.123.45 (tu IP)
```

### 7.2 Probar en Navegador

**NO funcionar√° todav√≠a** (porque el servidor no est√° configurado), pero puedes probar:

```bash
curl -I http://grupooosyris.es
```

**Es normal que de error** por ahora. Solo verificamos que DNS resuelve.

**‚è±Ô∏è Tiempo: 10 minutos**

---

## ‚öôÔ∏è Paso 8: Configuraciones Iniciales de Cloudflare

Mientras esperamos, configuremos algunas opciones.

### 8.1 SSL/TLS (IMPORTANTE)

1. Click en **"SSL/TLS"** (men√∫ lateral)
2. En **Overview**:
   - **Encryption mode:** Seleccionar **"Full (strict)"**
   - **‚ö†Ô∏è Cambiar DESPU√âS de obtener certificado SSL en el servidor**
   - **Por ahora:** Dejar en **"Flexible"** o **"Full"**

### 8.2 Speed ‚Üí Optimization

1. Click en **"Speed"** (men√∫ lateral)
2. Tab **"Optimization"**

**Configuraciones recomendadas:**

| Opci√≥n | Estado | Descripci√≥n |
|--------|--------|-------------|
| **Auto Minify** | ‚úÖ Activar HTML, CSS, JS | Reduce tama√±o archivos |
| **Brotli** | ‚úÖ Activar | Compresi√≥n avanzada |
| **Early Hints** | ‚úÖ Activar | Mejora velocidad carga |
| **Rocket Loader** | ‚ùå Desactivar | Puede causar problemas con Next.js |

### 8.3 Caching ‚Üí Configuration

1. Click en **"Caching"** (men√∫ lateral)
2. Tab **"Configuration"**

**Configuraciones recomendadas:**

| Opci√≥n | Valor | Descripci√≥n |
|--------|-------|-------------|
| **Caching Level** | Standard | Cach√© b√°sico |
| **Browser Cache TTL** | 4 hours | Tiempo de cach√© en navegador |

### 8.4 Security ‚Üí Settings

1. Click en **"Security"** (men√∫ lateral)
2. Tab **"Settings"**

**Configuraciones recomendadas:**

| Opci√≥n | Estado | Descripci√≥n |
|--------|--------|-------------|
| **Security Level** | Medium | Balance seguridad/usabilidad |
| **Challenge Passage** | 30 minutes | Tiempo de validaci√≥n |
| **Bot Fight Mode** | ‚úÖ Activar | Protecci√≥n bots b√°sica |

**‚è±Ô∏è Tiempo: 10 minutos**

---

## üìù Resumen de Configuraci√≥n

Guarda esta informaci√≥n:

```
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
CLOUDFLARE - OSYRIS SCOUT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

Email: admin@grupooosyris.es
Password: [tu contrase√±a]

Dashboard: https://dash.cloudflare.com

Dominio: grupooosyris.es
Status: ‚úÖ Active

Nameservers:
- bob.ns.cloudflare.com
- kate.ns.cloudflare.com

Plan: Free (‚Ç¨0/mes)

DNS Records:
- A @ ‚Üí 95.217.123.45 (DNS only)
- A www ‚Üí 95.217.123.45 (DNS only)

Fecha activaci√≥n: [fecha]
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

IMPORTANTE:
- Proxy status: DNS only (gris) ‚Üê TEMPORAL
- Cambiar a Proxied (naranja) DESPU√âS de obtener SSL
- SSL/TLS: Full (strict) ‚Üê Configurar DESPU√âS de SSL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
```

---

## ‚ö†Ô∏è Recordatorios Importantes

### üî¥ Proxy Status: DNS Only (Temporal)

**Estado actual:** üî¥ DNS only (gris)

**¬øPor qu√©?**
- Para obtener certificado SSL de Let's Encrypt
- Let's Encrypt necesita verificar el dominio directamente

**¬øCu√°ndo cambiar?**
- DESPU√âS de ejecutar `certbot` en el servidor
- Una vez tengas el certificado SSL instalado

**C√≥mo cambiar:**
1. Cloudflare Dashboard ‚Üí DNS ‚Üí Records
2. Click en el icono de nube gris
3. Se pondr√° naranja üü† (Proxied)

### üîí SSL/TLS Mode

**Estado actual:** Flexible o Full

**Cambiar a:** Full (strict)

**¬øCu√°ndo?**
- DESPU√âS de tener SSL en el servidor
- Verifica que HTTPS funciona en el servidor

**C√≥mo cambiar:**
1. Cloudflare Dashboard ‚Üí SSL/TLS
2. Encryption mode: **Full (strict)**

---

## üéØ Pr√≥ximos Pasos

Ahora que tienes todo configurado:

1. ‚úÖ **Servidor Hetzner creado**
2. ‚úÖ **Dominio registrado**
3. ‚úÖ **Cloudflare configurado**
4. ‚úÖ **DNS propagado**
5. ‚è≠Ô∏è **Siguiente:** Desplegar aplicaci√≥n en el servidor

---

## üÜò Troubleshooting

### Problema: DNS no propaga despu√©s de 24 horas

**Verificar:**
```bash
dig grupooosyris.es NS +short
```

**Si no muestra nameservers de Cloudflare:**
- Verificar que cambiaste correctamente en el registrador
- Verificar que el dominio no est√° bloqueado
- Contactar soporte del registrador

---

### Problema: Nameservers no se pueden cambiar

**Causas:**
- Dominio reci√©n registrado (espera 60 min)
- Dominio en periodo de transferencia
- Dominio bloqueado

**Soluci√≥n:**
- Espera 1 hora despu√©s del registro
- Contacta soporte del registrador

---

### Problema: "Too many redirects" al acceder

**Causa:** SSL/TLS configurado incorrectamente

**Soluci√≥n:**
1. Cloudflare ‚Üí SSL/TLS
2. Cambiar a "Flexible" temporalmente
3. Una vez funcionando, cambiar a "Full (strict)"

---

## üìû Soporte Cloudflare

- **Docs:** https://developers.cloudflare.com/
- **Community:** https://community.cloudflare.com/
- **Status:** https://www.cloudflarestatus.com/
- **Email:** Solo en planes de pago

**Plan Free:** Solo documentaci√≥n y community

---

## üí° Consejos Adicionales

### Analytics

Cloudflare proporciona analytics gratis:
1. Dashboard ‚Üí Analytics
2. Ver√°s: Tr√°fico, requests, ancho de banda, threats bloqueados

### Page Rules (Avanzado)

En el futuro puedes configurar reglas:
- Cache personalizado
- Redirecciones
- Bypass para ciertas URLs

**Plan Free:** 3 page rules gratis

### Firewall Rules

En Security ‚Üí WAF puedes a√±adir reglas personalizadas.

**Plan Free:** 5 reglas gratis

---

## ‚úÖ Checklist Final

Antes de continuar, verifica:

- [ ] Cuenta Cloudflare creada
- [ ] Dominio a√±adido a Cloudflare
- [ ] Nameservers cambiados en registrador
- [ ] DNS propagado (dig muestra IP correcta)
- [ ] Registros A configurados (@ y www)
- [ ] Proxy status en "DNS only" (gris)
- [ ] SSL/TLS en "Flexible" o "Full" (no strict todav√≠a)
- [ ] Informaci√≥n guardada de forma segura

---

**‚è±Ô∏è Tiempo total: 30-45 minutos + espera propagaci√≥n DNS (1-4 horas)**

---

*√öltima actualizaci√≥n: 30 Septiembre 2025*